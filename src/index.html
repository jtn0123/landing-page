<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>neuhard.dev ‚Äî Engineering &amp; Software Projects</title>
  <meta name="description" content="Full-stack engineering projects by neuhard ‚Äî interactive web apps, data systems, and more.">

  <!-- Open Graph -->
  <meta property="og:title" content="neuhard.dev ‚Äî Projects">
  <meta property="og:description" content="Full-stack engineering projects ‚Äî interactive web apps, data logging systems, and more.">
  <meta property="og:image" content="https://neuhard.dev/images/megabonk.png">
  <meta property="og:url" content="https://neuhard.dev/">
  <meta property="og:type" content="website">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="neuhard.dev ‚Äî Projects">
  <meta name="twitter:description" content="Full-stack engineering projects ‚Äî interactive web apps, data logging systems, and more.">
  <meta name="twitter:image" content="https://neuhard.dev/images/megabonk.png">

  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <a href="#main-content" class="skip-link">Skip to content</a>

  <header id="site-header">
    <h1>neuhard.dev</h1>
    <p>Engineering &amp; Software Projects</p>
  </header>

  <main id="main-content" class="projects">
    <article class="card fade-in" tabindex="0" data-link="https://neuhard.dev/megabonk/">
      <div class="card-img">
        <div class="carousel" data-interval="4000">
          <img src="images/megabonk-1.png" alt="MegaBonk items view" class="carousel-slide active lightbox-trigger">
          <img src="images/megabonk-2.png" alt="MegaBonk scrolled view" class="carousel-slide lightbox-trigger">
          <div class="carousel-dots">
            <span class="dot active"></span>
            <span class="dot"></span>
          </div>
        </div>
      </div>
      <div class="card-body">
        <h2>MegaBonk</h2>
        <p class="desc">The ultimate reference guide for MegaBonk ‚Äî items, weapons, tomes, characters, shrines, build planner, and breakpoint calculator in one interactive web app.</p>
        <div class="tech">
          <span>TypeScript</span>
          <span>Vite</span>
          <span>Playwright</span>
          <span>Chart.js</span>
        </div>
        <div class="buttons">
          <a href="https://neuhard.dev/megabonk/" class="btn btn-primary">Live App</a>
          <a href="https://github.com/jtn0123/MegaBonk" class="btn">GitHub</a>
        </div>
      </div>
    </article>

    <article class="card fade-in" tabindex="0" data-link="https://neuhard.dev/volttracker/" style="--fade-delay: 200ms">
      <div class="card-img">
        <div class="carousel" data-interval="4000">
          <img src="images/volttracker-1.png" alt="VoltTracker dashboard" class="carousel-slide active lightbox-trigger">
          <img src="images/volttracker-2.png" alt="VoltTracker trips section" class="carousel-slide lightbox-trigger">
          <img src="images/volttracker-3.png" alt="VoltTracker map view" class="carousel-slide lightbox-trigger">
          <div class="carousel-dots">
            <span class="dot active"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </div>
        </div>
      </div>
      <div class="card-body">
        <h2>VoltTracker</h2>
        <p class="desc">Self-hosted data logging and analysis system for the Chevy Volt. Receives OBD-II telemetry from Torque Pro, tracks fuel efficiency, battery health, and charging analytics.</p>
        <div class="tech">
          <span>Python</span>
          <span>Flask</span>
          <span>PostgreSQL</span>
          <span>TimescaleDB</span>
          <span>Redis</span>
          <span>Docker</span>
          <span>TypeScript</span>
        </div>
        <div class="buttons">
          <a href="https://neuhard.dev/volttracker/" class="btn btn-primary">Live App</a>
          <a href="https://github.com/jtn0123/VoltTracker" class="btn">GitHub</a>
        </div>
      </div>
    </article>
  </main>

  <!-- Stats Bar -->
  <section class="stats-bar fade-in">
    <div class="stat">
      <span class="stat-value" id="total-loc">‚Äî</span>
      <span class="stat-label">Lines of Code</span>
    </div>
    <div class="stat">
      <span class="stat-value" id="total-commits">‚Äî</span>
      <span class="stat-label">Commits</span>
    </div>
    <div class="stat">
      <span class="stat-value" id="total-projects">2</span>
      <span class="stat-label">Projects</span>
    </div>
  </section>

  <!-- Tech Stack -->
  <section class="tech-grid-section fade-in">
    <h2>Tech Stack</h2>
    <div class="tech-grid">
      <div class="tech-item" style="--tc:#3178c6">
        <svg viewBox="0 0 128 128" width="28" height="28"><path fill="#3178c6" d="M2 63.91v62.5h125v-125H2zm100.73-5.01h-23.9v68.18h-13.9V58.9h-23.9V47.01h61.7z"/></svg>
        <span>TypeScript</span>
      </div>
      <div class="tech-item" style="--tc:#3572A5">
        <span class="tech-icon">üêç</span>
        <span>Python</span>
      </div>
      <div class="tech-item" style="--tc:#f7df1e">
        <span class="tech-icon" style="color:#f7df1e;font-weight:900;font-size:1.2rem">JS</span>
        <span>JavaScript</span>
      </div>
      <div class="tech-item" style="--tc:#e44d26">
        <span class="tech-icon" style="color:#e44d26;font-weight:900;font-size:1rem">&lt;/&gt;</span>
        <span>HTML/CSS</span>
      </div>
      <div class="tech-item" style="--tc:#000">
        <span class="tech-icon">‚ö°</span>
        <span>Flask</span>
      </div>
      <div class="tech-item" style="--tc:#646cff">
        <span class="tech-icon" style="color:#646cff;font-weight:900;font-size:1.1rem">‚ö°</span>
        <span>Vite</span>
      </div>
      <div class="tech-item" style="--tc:#ff6384">
        <span class="tech-icon" style="color:#ff6384;font-size:1.1rem">üìä</span>
        <span>Chart.js</span>
      </div>
      <div class="tech-item" style="--tc:#199900">
        <span class="tech-icon" style="color:#199900;font-size:1.1rem">üó∫Ô∏è</span>
        <span>Leaflet</span>
      </div>
      <div class="tech-item" style="--tc:#336791">
        <span class="tech-icon">üêò</span>
        <span>PostgreSQL</span>
      </div>
      <div class="tech-item" style="--tc:#fdb515">
        <span class="tech-icon" style="color:#fdb515;font-size:1.1rem">‚è±Ô∏è</span>
        <span>TimescaleDB</span>
      </div>
      <div class="tech-item" style="--tc:#d82c20">
        <span class="tech-icon" style="color:#d82c20;font-weight:900;font-size:0.9rem">‚óÜ</span>
        <span>Redis</span>
      </div>
      <div class="tech-item" style="--tc:#2496ed">
        <span class="tech-icon">üê≥</span>
        <span>Docker</span>
      </div>
      <div class="tech-item" style="--tc:#2088ff">
        <span class="tech-icon">‚öôÔ∏è</span>
        <span>GitHub Actions</span>
      </div>
      <div class="tech-item" style="--tc:#f38020">
        <span class="tech-icon" style="color:#f38020;font-weight:900;font-size:0.9rem">‚òÅÔ∏è</span>
        <span>Cloudflare</span>
      </div>
      <div class="tech-item" style="--tc:#2ead33">
        <span class="tech-icon" style="color:#2ead33;font-size:1.1rem">üé≠</span>
        <span>Playwright</span>
      </div>
      <div class="tech-item" style="--tc:#729b1b">
        <span class="tech-icon" style="color:#729b1b;font-weight:900;font-size:0.9rem">‚ö°</span>
        <span>Vitest</span>
      </div>
    </div>
  </section>

  <!-- Recent Activity Timeline -->
  <section id="activity" class="timeline-section">
    <h2>Recent Activity</h2>
    <div id="timeline" class="timeline">
      <div class="timeline-loading">
        <div class="skeleton-item"></div>
        <div class="skeleton-item"></div>
        <div class="skeleton-item"></div>
      </div>
    </div>
  </section>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" role="dialog" aria-modal="true" aria-label="Image preview">
    <img id="lightbox-img" src="" alt="">
  </div>

  <footer>v3.0.0 ¬∑ ¬© 2026 neuhard.dev</footer>

  <script>
    // --- Sticky header ---
    const header = document.getElementById('site-header');
    window.addEventListener('scroll', () => {
      header.classList.toggle('scrolled', window.scrollY > 40);
    }, { passive: true });

    // --- Fade-in on scroll ---
    const fadeEls = document.querySelectorAll('.fade-in');
    const fadeObserver = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          e.target.classList.add('visible');
          fadeObserver.unobserve(e.target);
        }
      });
    }, { threshold: 0.15 });
    fadeEls.forEach(el => fadeObserver.observe(el));

    // --- Keyboard nav for cards ---
    document.querySelectorAll('.card[data-link]').forEach(card => {
      card.addEventListener('keydown', e => {
        if (e.key === 'Enter') {
          const link = card.querySelector('.btn-primary');
          if (link) link.click();
        }
      });
    });

    // --- Lightbox ---
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img');
    document.querySelectorAll('.lightbox-trigger').forEach(img => {
      img.style.cursor = 'zoom-in';
      img.addEventListener('click', e => {
        e.preventDefault();
        e.stopPropagation();
        lightboxImg.src = img.src;
        lightboxImg.alt = img.alt;
        lightbox.classList.add('active');
      });
    });
    lightbox.addEventListener('click', () => lightbox.classList.remove('active'));
    document.addEventListener('keydown', e => {
      if (e.key === 'Escape') lightbox.classList.remove('active');
    });

    // --- Carousel ---
    document.querySelectorAll('.carousel').forEach(carousel => {
      const slides = carousel.querySelectorAll('.carousel-slide');
      const dots = carousel.querySelectorAll('.dot');
      if (slides.length < 2) return;

      let current = 0;
      let paused = false;
      const interval = parseInt(carousel.dataset.interval) || 4000;

      function goTo(idx) {
        slides[current].classList.remove('active');
        dots[current].classList.remove('active');
        current = idx % slides.length;
        slides[current].classList.add('active');
        dots[current].classList.add('active');
      }

      carousel.addEventListener('mouseenter', () => paused = true);
      carousel.addEventListener('mouseleave', () => paused = false);

      dots.forEach((dot, i) => {
        dot.addEventListener('click', e => { e.stopPropagation(); goTo(i); });
      });

      setInterval(() => { if (!paused) goTo(current + 1); }, interval);
    });

    // --- Animated counter ---
    function animateCounter(el, target) {
      const duration = 1200;
      const start = performance.now();
      function tick(now) {
        const progress = Math.min((now - start) / duration, 1);
        const eased = 1 - Math.pow(1 - progress, 3);
        el.textContent = Math.floor(eased * target).toLocaleString();
        if (progress < 1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    }

    // --- Lazy Stats Loading ---
    const statsBar = document.querySelector('.stats-bar');
    let statsLoaded = false;
    const statsObserver = new IntersectionObserver((entries) => {
      if (entries[0].isIntersecting && !statsLoaded) {
        statsLoaded = true;
        statsObserver.unobserve(statsBar);
        loadStats();
      }
    }, { rootMargin: '200px' });
    statsObserver.observe(statsBar);

    async function loadStats() {
      const cacheKey = 'neuhard_stats';
      const cacheTTL = 10 * 60 * 1000;

      try {
        const cached = JSON.parse(sessionStorage.getItem(cacheKey));
        if (cached && Date.now() - cached.ts < cacheTTL) {
          showStats(cached.data);
          return;
        }
      } catch {}

      try {
        const [mbLang, vtLang, mbRepo, vtRepo] = await Promise.all([
          fetch('https://api.github.com/repos/jtn0123/MegaBonk/languages').then(r => r.json()),
          fetch('https://api.github.com/repos/jtn0123/VoltTracker/languages').then(r => r.json()),
          fetch('https://api.github.com/repos/jtn0123/MegaBonk').then(r => r.json()),
          fetch('https://api.github.com/repos/jtn0123/VoltTracker').then(r => r.json()),
        ]);

        const totalBytes = Object.values(mbLang).reduce((a, b) => a + b, 0)
                         + Object.values(vtLang).reduce((a, b) => a + b, 0);
        const loc = Math.round(totalBytes / 40);

        // Fetch contributor stats for commit counts
        const [mbContribs, vtContribs] = await Promise.all([
          fetch('https://api.github.com/repos/jtn0123/MegaBonk/contributors').then(r => r.json()),
          fetch('https://api.github.com/repos/jtn0123/VoltTracker/contributors').then(r => r.json()),
        ]);
        const commits = (Array.isArray(mbContribs) ? mbContribs.reduce((a, c) => a + c.contributions, 0) : 0)
                      + (Array.isArray(vtContribs) ? vtContribs.reduce((a, c) => a + c.contributions, 0) : 0);

        const data = { loc, commits };
        sessionStorage.setItem(cacheKey, JSON.stringify({ ts: Date.now(), data }));
        showStats(data);
      } catch {
        document.getElementById('total-loc').textContent = '‚Äî';
        document.getElementById('total-commits').textContent = '‚Äî';
      }
    }

    function showStats({ loc, commits }) {
      animateCounter(document.getElementById('total-loc'), loc);
      animateCounter(document.getElementById('total-commits'), commits);
    }

    // --- Lazy Timeline Loading ---
    const timelineSection = document.getElementById('activity');
    let timelineLoaded = false;
    const timelineObserver = new IntersectionObserver((entries) => {
      if (entries[0].isIntersecting && !timelineLoaded) {
        timelineLoaded = true;
        timelineObserver.unobserve(timelineSection);
        loadTimeline();
      }
    }, { rootMargin: '200px' });
    timelineObserver.observe(timelineSection);

    async function loadTimeline() {
      const timelineEl = document.getElementById('timeline');
      const cacheKey = 'neuhard_commits';
      const cacheTTL = 5 * 60 * 1000;

      function relativeTime(dateStr) {
        const diff = Date.now() - new Date(dateStr).getTime();
        const mins = Math.floor(diff / 60000);
        if (mins < 1) return 'just now';
        if (mins < 60) return mins + 'm ago';
        const hrs = Math.floor(mins / 60);
        if (hrs < 24) return hrs + 'h ago';
        const days = Math.floor(hrs / 24);
        if (days < 30) return days + 'd ago';
        return Math.floor(days / 30) + 'mo ago';
      }

      function truncate(str, len) {
        return str.length > len ? str.slice(0, len) + '‚Ä¶' : str;
      }

      function renderTimeline(commits) {
        if (!commits.length) {
          timelineEl.innerHTML = '<p class="timeline-empty">No recent activity</p>';
          return;
        }
        timelineEl.innerHTML = '<div class="timeline-line"></div>' +
          commits.map((c, i) => `
            <div class="timeline-item ${i % 2 === 0 ? 'left' : 'right'}">
              <div class="timeline-dot"></div>
              <div class="timeline-content">
                <p class="commit-msg">${truncate(c.message.split('\n')[0], 60)}</p>
                <div class="commit-meta">
                  <span class="repo-badge repo-${c.repo.toLowerCase()}">${c.repo}</span>
                  ${c.additions != null ? `<span class="stat-add">+${c.additions}</span>` : ''}
                  ${c.deletions != null ? `<span class="stat-del">-${c.deletions}</span>` : ''}
                  <span class="commit-time">${relativeTime(c.date)}</span>
                </div>
              </div>
            </div>
          `).join('');
      }

      try {
        const cached = JSON.parse(sessionStorage.getItem(cacheKey));
        if (cached && Date.now() - cached.ts < cacheTTL) {
          renderTimeline(cached.data);
          return;
        }
      } catch {}

      try {
        const [mbRes, vtRes] = await Promise.all([
          fetch('https://api.github.com/repos/jtn0123/MegaBonk/commits?per_page=5'),
          fetch('https://api.github.com/repos/jtn0123/VoltTracker/commits?per_page=5')
        ]);
        if (!mbRes.ok && !vtRes.ok) throw new Error('API failed');

        const parse = async (res, repo) => {
          if (!res.ok) return [];
          const data = await res.json();
          return data.map(c => ({
            message: c.commit.message,
            date: c.commit.committer.date,
            repo,
            url: c.html_url,
            sha: c.sha
          }));
        };

        const commits = [
          ...await parse(mbRes, 'MegaBonk'),
          ...await parse(vtRes, 'VoltTracker')
        ].sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10);

        await Promise.all(commits.map(async (c) => {
          try {
            const r = await fetch(`https://api.github.com/repos/jtn0123/${c.repo}/commits/${c.sha}`);
            if (r.ok) {
              const detail = await r.json();
              c.additions = detail.stats?.additions || 0;
              c.deletions = detail.stats?.deletions || 0;
            }
          } catch {}
        }));

        sessionStorage.setItem(cacheKey, JSON.stringify({ ts: Date.now(), data: commits }));
        renderTimeline(commits);
      } catch {
        timelineEl.innerHTML = '<p class="timeline-empty">Unable to load recent activity</p>';
      }
    }
  </script>
</body>
</html>
